{% extends 'core/base.html' %}
{% load static %}

{% block title %}
    {% if direccion %}Editar Dirección{% else %}Crear Dirección{% endif %}
{% endblock %}

{% block content %}
<div class="content-header mb-4">
    <h1 class="mb-1">
        {% if direccion %}Editar Dirección{% else %}Crear Dirección{% endif %}
    </h1>
    <p class="text-muted">
        {% if direccion %}Modifica la información de la dirección.{% else %}Registra una nueva dirección en la plataforma.{% endif %}
    </p>
</div>

<div class="row justify-content-center">
    <div class="col-md-8 col-lg-7">
        <div class="card shadow-sm">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0">Datos de la Dirección</h5>
            </div>
            <div class="card-body">
                
                <form method="POST" action="">
                    {% csrf_token %}
                    
                    <div class="mb-3">
                        <label for="nombre" class="form-label">Nombre de la Dirección</label>
                        <input type="text" class="form-control" id="nombre" name="nombre" 
                               value="{% if direccion %}{{ direccion.nombre }}{% endif %}" required>
                    </div>

                    <div class="mb-3">
                        <label for="encargado" class="form-label">Encargado</label>
                        <select class="form-select" id="encargado" name="encargado" required>
                            <option value="">Seleccione un encargado...</option>
                            {% for encargado in encargados %}
                                <option value="{{ encargado.id }}" 
                                        data-correo="{{ encargado.email }}"
                                        {% if direccion and direccion.encargado.id == encargado.id %}selected{% endif %}>
                                    {{ encargado.username }} ({{ encargado.first_name }} {{ encargado.last_name }}) 
                                </option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="mb-3">
                        <label for="correo_encargado" class="form-label">Correo del Encargado</label>
                        <input type="email" class="form-control" id="correo_encargado" name="correo_encargado" 
                               value="{% if direccion %}{{ direccion.correo_encargado }}{% endif %}" required>
                    </div>

                    <div class="d-flex justify-content-between mt-4">
                        <button type="submit" class="btn btn-primary">
                            {% if direccion %}Actualizar Dirección{% else %}Crear Dirección{% endif %}
                        </button>
                        
                        <a href="{% url 'direccion_listar' %}" class="btn btn-secondary">
                            Cancelar
                        </a>
                    </div>

                </form>
            </div>
        </div>
    </div>
</div>

{% load static %}
<script src="{% static 'includes/js/autocompletar_correo.js' %}"></script>
{% endblock %}