{% extends "core/base.html" %}

{% block content %}
<h4>Gestión de Incidencias</h4>

<a href="{% url 'crear_incidencia' %}">Nueva Incidencia</a>
<br><br>

<table border="1">
    <thead>
        <tr>
            <th>#</th>
            <th>Nombre Incidencia</th>
            <th>Dirección</th>
            <th>Departamento</th>
            <th>Estado</th>
            <th>Acciones</th>
        </tr>
    </thead>

    <tbody>
    {% for incidencia in incidencias %}
        <tr>
            <td>{{ forloop.counter }}</td>

            <td>
                {{ incidencia.encuesta.tipo_incidencia.nombre }}
            </td>

            <td>
                {% if incidencia.direccion %}
                    {{ incidencia.direccion }}
                {% else %}
                    Sin dirección
                {% endif %}
            </td>

            <td>
                {% if incidencia.departamento %}
                    {{ incidencia.departamento.nombre }}
                {% else %}
                    -
                {% endif %}
            </td>

            <td>{{ incidencia.get_estado_display }}</td>

            <td>
                <a href="#">Ver</a>
                <a href="{% url 'editar_incidencia' incidencia.id %}">Editar</a>
                <a href="{% url 'eliminar_incidencia' incidencia.id %}">Eliminar</a>
            </td>
        </tr>
    {% empty %}
        <tr>
            <td colspan="6">No hay incidencias.</td>
        </tr>
    {% endfor %}
    </tbody>
</table>

<a href="{% url 'dashboard' %}">Volver al Menú Principal</a>
{% endblock %}
